---
title: "p8105_hw2_yw3995"
author: "Yuxuan Wang"
date: "2023-10-04"
output: github_document
---

# Problem 0

```{r setup, include = FALSE}
library(tidyverse)
library(readxl)
```

# Problem 1

## Clean the data in pols-month.csv

```{r, message = FALSE}
pols_df = 
  read_csv(file = "./data/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(mon, into = c("year", "month", "day")) %>% 
  mutate(month = month.abb[as.numeric(month)]) %>% 
  mutate(president = ifelse(prez_dem == 0, "dem", "gop")) %>% 
  select(-prez_dem, -prez_gop, -day)

pols_df
```

## Clean the data in snp.csv

```{r, message = FALSE}
snp_df = 
  read_csv(file = "./data/snp.csv") %>% 
  janitor::clean_names() %>% 
  mutate(date = as.Date(date, format = "%m/%d/%y"),
         date = as.Date(ifelse(date > Sys.Date(),
                               format(date, "19%y-%m-%d"),
                               format(date)))) %>% 
  separate(date, into = c("year", "month", "day")) %>% 
  mutate(month = month.abb[as.numeric(month)]) %>% 
  select(-day) %>% 
  arrange(year, month) %>% 
  relocate(year, month)

snp_df
```

## Clean the data in unemployment.csv

```{r, message = FALSE}
unemployment_df = 
  read_csv(file = "./data/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "percentage") %>% 
  mutate(month = str_to_title(month))

unemployment_df$year = as.character(unemployment_df$year)

unemployment_df
```

## Merging

```{r, message = FALSE}
polssnp_df = 
  merge(pols_df, snp_df, by = c("year", "month")) %>% 
  arrange(year, month)
```

```{r, message = FALSE}
merge_df = 
  merge(polssnp_df, unemployment_df, by = c("year", "month")) %>% 
  arrange(year) %>% 
  relocate(year)
```

* Conclusion

  * The dataset **"pols_df"** is about the date and the number of national politicians who are democratic or republican from **Jan. 1947** to **Jun. 2015**, which contains **`r names(pols_df)`** and the size of the dataset is **`r nrow (pols_df)`** rows * **`r ncol(pols_df)`** cols;
  *  The dataset **"snp_df"** is about the date and values of Standard & Poorâ€™s stock market index (S&P) from **Jan. 1950** to **Jul. 2015**, which contains **`r names(snp_df)`** and the size of the dataset is **`r nrow (snp_df)`** rows * **`r ncol(snp_df)`** cols;
  *  The dataset **"unemployment_df"** is about the date and the percentage of unemployment from **Jan. 1948** to **Dec. 2015**, which contains **`r names(unemployment_df)`** and the size of the dataset is **`r nrow (unemployment_df)`** rows * **`r ncol(unemployment_df)`** cols;
  * The dataset **"merge_df"** is the sum of the above three files, containing the number of national politicians, closing values of the S&P stock index, and the percentage of unemployed from **Jan. 1950** to **Jun. 2015**, which contains **`r names(merge_df)`** and the size of the dataset is **`r nrow (merge_df)`** rows * **`r ncol(merge_df)`** cols.